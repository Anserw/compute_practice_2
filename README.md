# 数值分析 计算实习 第二题 
SY1517303 徐子尧

## 题目描述
试求矩阵$A=[a_{ij}]_{10\times10}$的全部特征值，并对其中的每一个实特征值求相应的特征向量。已知 
$$a_{i,j}=\left\{\begin{matrix}sin(0.5i+0.2j)
 & i\neq j\\1.52cos(i+1.2j) 
 & i=j
\end{matrix}\right. \qquad   (i,j=1,2,\cdots ,10)$$

### 说明： 
1. 求矩阵特征值时，要求迭代的精度水平为$\varepsilon=10^{-12} $
2. 打印以下内容： 
    - 全部源程序。 
    - 矩阵$A$经过拟上三角化后所得的矩阵$A^{(n-1)}$
    - 对矩阵$A^{(n-1)}$实行QR分解方法结束后所得的矩阵。 
    - 矩阵A的全部特征值$\lambda_i=(R_i, I_i) \ (i=1,2,\cdots ,10)$，其中$R_i=Re(\lambda_i), I_i=Im(\lambda_i)$，若$\lambda_i$是实数，就令$I_i=0$。 
    - 矩阵$A$的相应于实特征值的特征向量。 
3. 采用e型输出实型数，并且至少显示12位有效数字。

## 算法设计

```flow
st=>start: Start
e=>end: end
op0=>operation: 初始化矩阵，计算初值
op1=>operation: 矩阵的拟上三角化
op2=>operation: 用带双步位移的QR方法求解所有特征值
cond1=>condition: 判断是否是实特征值
op3=>operation: 用Gauss消去法求解对应的特征向量
opqr=>operation: 计算拟上三角化后矩阵的QR分解，并打印RQ
io=>inputoutput: 输出结果
st->op0->opqr->op1->op2->cond1
cond1(yes)->op3
cond1(no)->io
op3->io
io->e
```


1. 拟上三角化
按照*数值分析, 闫庆津, 第四版*中61页3.3.2的方法，求得矩阵A经过拟上三角化后的矩阵$A^{(n-1)}$。
此步可以为后续计算减少计算量。

2. 带双步位移的QR方法
按照*数值分析, 闫庆津, 第四版*中62页3.3.3的方法。
QR方法产生的矩阵序列本质上收敛于分块上三角阵。对角块均是一阶或二阶子块，对每个子块求特征值就得到整个矩阵的所有特征值。为加速收敛，采用带双步位移的QR分解法。记最大迭代次数为Max，取为1000，迭代精度为e=1e-12。
每次迭代前检查，若下一个子块满足条件（一阶或二阶），输所有特征值，计算完成。若达到最大迭代次数仍未输出所有特征值，则返回错误信息，计算失败。

3. 列主元素Gauss消去法
按照*数值分析, 闫庆津, 第四版*中16页2.1.2的方法。
对每个实特征值$λ_i$，解线性方程$(A-λ_i I)X=0$，因为系数矩阵非满秩的，统一置特征向量的最后一个值为1。



## 问题与分析
带双步位移的QR方法中，在复数的处理上遇到了问题。由于没有顾及到复数解，在初次运行时并没有得到正确的结果。后自行定义的复数的类型，解决了这个问题。
